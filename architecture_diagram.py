"""
Application Architecture Diagram Generator
Generates visual representation of auto_chat_24_7 system architecture
Exports as both ASCII and PNG images
"""

import os
from PIL import Image, ImageDraw, ImageFont

def generate_ascii_architecture():
    """Generate ASCII architecture diagram"""
    
    diagram = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    AUTO_CHAT_24_7 SYSTEM ARCHITECTURE                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              EXTERNAL SYSTEMS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“§ MAIL PORTAL  â”‚         â”‚   ğŸ“¬ GMAIL IMAP  â”‚     â”‚  ğŸ“¤ SMTP SERVER  â”‚   â”‚
â”‚  â”‚  (Inbox)         â”‚         â”‚  (imap.gmail.com)â”‚     â”‚ (smtp.gmail.com) â”‚   â”‚
â”‚  â”‚                  â”‚         â”‚                  â”‚     â”‚                  â”‚   â”‚
â”‚  â”‚ â€¢ Receive emails â”‚         â”‚ â€¢ SSL/TLS Auth   â”‚     â”‚ â€¢ SSL/TLS Auth   â”‚   â”‚
â”‚  â”‚ â€¢ Store messages â”‚         â”‚ â€¢ Fetch unseen   â”‚     â”‚ â€¢ Send responses â”‚   â”‚
â”‚  â”‚ â€¢ Track status   â”‚         â”‚ â€¢ Parse headers  â”‚     â”‚ â€¢ Queue emails   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                            â”‚                        â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                            â”‚                        â”‚
            â”‚ (IMAP Protocol)            â”‚ (SMTP Protocol)        â”‚
            â”‚                            â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ”’ APPLICATION LAYER                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    EMAIL PROCESSOR MODULE                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  fetch_unseen_emails()                                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Connect to IMAP server                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Retrieve unseen messages                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Parse email headers (From, Subject)                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Extract body with charset handling                              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Return: (eid, sender, subject, body)                            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  send_email(to_addr, subject, body)                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Connect to SMTP server                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Format MIME message                                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Authenticate & send                                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Handle errors                                                   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ORCHESTRATION MODULE                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  auto_process()                                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Fetch unseen emails                                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ For each email:                                                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    1. Extract content                                              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    2. Create LLM prompt                                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    3. Generate reply                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    4. Send reply to sender                                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    5. Forward to coworker                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Handle exceptions                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Sleep 60 seconds                                                â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Prompt
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ¤– AI/NLP PROCESSING LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  OllamaLanguageModel                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  generate(prompt, output_format=None, n_completions=1)             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 1ï¸âƒ£ ANONYMIZATION (if anonymize=True)                       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Anonymizer.anonymize_data(prompt)                    â”‚  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ spaCy NER: Detect PII entities                     â”‚  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Replace with: [LABEL_UUID]                         â”‚  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Store mappings: {original â†’ placeholder}           â”‚  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Output: anonymized_prompt, mappings                â”‚  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 2ï¸âƒ£ LLM INFERENCE (Ollama)                                  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Send to: http://localhost:11434                      â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Model: mistral:latest (or mixtral, llama3)           â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Config: temperature=0.7                              â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Request: anonymized_prompt                           â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Output: raw_response (text)                          â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 3ï¸âƒ£ DE-ANONYMIZATION (if anonymize=True)                   â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Deanonymizer.deanonymize_response(response, mappings)â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Match placeholders: [LABEL_UUID]                   â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Replace with: original values                      â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Restore context                                    â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ â€¢ Output: final_response                             â”‚  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Return: final_response (text or structured)                       â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Generated Reply
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“ LOGGING & TRACKING LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ğŸ“„ Before.txt   â”‚    â”‚  ğŸ“„ After.txt    â”‚    â”‚  ğŸ“„ Response.txt â”‚         â”‚
â”‚  â”‚  (Anonymization) â”‚    â”‚  (Anonymized)    â”‚    â”‚  (LLM Output)    â”‚         â”‚
â”‚  â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚         â”‚
â”‚  â”‚ â€¢ Original text  â”‚    â”‚ â€¢ Anonymized     â”‚    â”‚ â€¢ Generated      â”‚         â”‚
â”‚  â”‚ â€¢ Timestamp      â”‚    â”‚   content        â”‚    â”‚   reply text     â”‚         â”‚
â”‚  â”‚ â€¢ Metadata       â”‚    â”‚ â€¢ Timestamp      â”‚    â”‚ â€¢ Timestamp      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚              ğŸ“‹ Map.txt (Mappings)                        â”‚                 â”‚
â”‚  â”‚  â€¢ Entity type â†’ UUID mappings                           â”‚                 â”‚
â”‚  â”‚  â€¢ Original value â†’ Placeholder mapping                  â”‚                 â”‚
â”‚  â”‚  â€¢ For audit & de-anonymization                          â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
    return diagram

def generate_ascii_dataflow():
    """Generate ASCII data flow diagram"""
    
    diagram = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                            DATA FLOW DIAGRAM                                    â•‘
â•‘                          AUTO_CHAT_24_7 SYSTEM                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


                            Sender's Email (Gmail)
                                   â”‚
                                   â”‚ IMAP Fetch
                                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  Email Content   â”‚
                           â”‚  From: ...       â”‚
                           â”‚  Subject: ...    â”‚
                           â”‚  Body: ...       â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Extract & Process
                                    â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Create Prompt    â”‚ â—„â”€â”€â”€â”€â”€â”€ "Reply politely to..."
                            â”‚  from Email Body  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Raw Prompt
                                     â”‚ (if anonymize=True)
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ğŸ” ANONYMIZATION STEP        â”‚
                            â”‚                               â”‚
                            â”‚  Input:  Raw Prompt           â”‚
                            â”‚          "John Doe called..." â”‚
                            â”‚                               â”‚
                            â”‚  Process: spaCy NER           â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                            â”‚  â”‚ Detect Entity Types:    â”‚  â”‚
                            â”‚  â”‚ âœ“ PERSON (John Doe)    â”‚  â”‚
                            â”‚  â”‚ âœ“ ORG (CompanyName)    â”‚  â”‚
                            â”‚  â”‚ âœ“ GPE (Location)       â”‚  â”‚
                            â”‚  â”‚ âœ“ PHONE, EMAIL, DATE  â”‚  â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                            â”‚                               â”‚
                            â”‚  Generate UUIDs for each      â”‚
                            â”‚  entity (0000-9999)           â”‚
                            â”‚                               â”‚
                            â”‚  Output: "[PERSON_0001]       â”‚
                            â”‚          called..."           â”‚
                            â”‚          Mappings: {          â”‚
                            â”‚            "PERSON":          â”‚
                            â”‚              "John Doe":      â”‚
                            â”‚              "[PERSON_0001]"  â”‚
                            â”‚            "ORG":             â”‚
                            â”‚              "Acme Corp":     â”‚
                            â”‚              "[ORG_0002]"     â”‚
                            â”‚          }                    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Anonymized Prompt + Mappings
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ ğŸ’¾ LOG: Before.txt       â”‚
                            â”‚ (Original prompt)        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Anonymized Prompt
                                     â”‚ (if anonymize=True)
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ ğŸ’¾ LOG: After.txt        â”‚
                            â”‚ (Anonymized prompt)      â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Anonymized Prompt
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ ğŸ’¾ LOG: Map.txt          â”‚
                            â”‚ (Mappings stored)        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Anonymized Prompt
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ğŸ¤– LLM (Ollama/Mistral)     â”‚
                            â”‚                             â”‚
                            â”‚  Endpoint:                  â”‚
                            â”‚  http://localhost:11434     â”‚
                            â”‚                             â”‚
                            â”‚  Model Config:              â”‚
                            â”‚  â”œâ”€ mistral:latest          â”‚
                            â”‚  â”œâ”€ temperature: 0.7        â”‚
                            â”‚  â””â”€ top_p: 0.9              â”‚
                            â”‚                             â”‚
                            â”‚  Process Anonymized:        â”‚
                            â”‚  "[PERSON_0001] called     â”‚
                            â”‚   [ORG_0002] yesterday..."  â”‚
                            â”‚                             â”‚
                            â”‚  Generate Response:         â”‚
                            â”‚  "[PERSON_0001] was a      â”‚
                            â”‚   good call, thanks!"       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ LLM Response (anonymized)
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ğŸ’¾ LOG: Response.txt (raw)    â”‚
                            â”‚  Before De-anonymization       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Anonymized Response + Mappings
                                     â”‚ (if anonymize=True)
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ğŸ”“ DE-ANONYMIZATION STEP     â”‚
                            â”‚                               â”‚
                            â”‚  Input:  "[PERSON_0001]       â”‚
                            â”‚           was a good call..." â”‚
                            â”‚           Mappings (from step 1): â”‚
                            â”‚           {PERSON: John Doe   â”‚
                            â”‚            -> [PERSON_0001]}  â”‚
                            â”‚                               â”‚
                            â”‚  Process:                     â”‚
                            â”‚  1. Find [PERSON_0001] in    â”‚
                            â”‚     response                  â”‚
                            â”‚  2. Look up mapping:          â”‚
                            â”‚     [PERSON_0001]            â”‚
                            â”‚     -> "John Doe"            â”‚
                            â”‚  3. Replace placeholder       â”‚
                            â”‚  4. Verify context           â”‚
                            â”‚                               â”‚
                            â”‚  Output: "John Doe was a      â”‚
                            â”‚           good call..."       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Final Reply (restored)
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ğŸ’¾ LOG: Response.txt    â”‚
                            â”‚  Final (De-anonymized)   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Final Reply Text
                                     â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     FORMAT EMAIL MESSAGE           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  ğŸ“¤ SEND TO SENDER   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  â”‚ To: sender@example.com       â”‚  â”‚                      â”‚  â”‚  ğŸ“¤ FORWARD TO COWORKER
                    â”‚  â”‚ Subject: Re: [original]      â”‚  â”‚ To: sender@...      â”‚  â”‚ To: coworker@...
                    â”‚  â”‚ Body: Final reply text       â”‚  â”‚ Subject: Re: ...    â”‚  â”‚ Subject: FWD: ...
                    â”‚  â”‚ MIME-Type: text/plain       â”‚  â”‚ Body: Auto reply    â”‚  â”‚ Body: Reply (may include
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                      â”‚  â”‚       original context)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                     â”‚
                  â–¼ (SMTP)              â–¼ (SMTP)
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸ“¤ SEND TO SENDER   â”‚  â”‚ ğŸ“¤ FORWARD TO COWORKER
        â”‚                      â”‚  â”‚
        â”‚  To: sender@...      â”‚  â”‚ To: coworker@...
        â”‚  Subject: Re: ...    â”‚  â”‚ Subject: FWD: ...
        â”‚  Body: Auto reply    â”‚  â”‚ Body: Reply (may include
        â”‚                      â”‚  â”‚       original context)
        â”‚  Status: âœ… Sent     â”‚  â”‚ Status: âœ… Sent
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  âœ… PROCESS COMPLETE â”‚
                    â”‚                      â”‚
                    â”‚  Wait 60 seconds     â”‚
                    â”‚  Check for new emails
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        KEY TRANSFORMATION POINTS                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ANONYMIZATION MAPPING EXAMPLE:
   
   Original Text:
   "Hello John Doe (john@example.com), this is from Acme Corp, call +1-555-0123"
   
   After spaCy NER Detection:
   â€¢ PERSON: "John Doe" â†’ [PERSON_0001]
   â€¢ EMAIL: "john@example.com" â†’ [EMAIL_0002]
   â€¢ ORG: "Acme Corp" â†’ [ORG_0003]
   â€¢ PHONE: "+1-555-0123" â†’ [PHONE_0004]
   
   Anonymized Text:
   "Hello [PERSON_0001] ([EMAIL_0002]), this is from [ORG_0003], call [PHONE_0004]"
   
   Mappings JSON:
   {
     "PERSON": {"John Doe": "[PERSON_0001]"},
     "EMAIL": {"john@example.com": "[EMAIL_0002]"},
     "ORG": {"Acme Corp": "[ORG_0003]"},
     "PHONE": {"+1-555-0123": "[PHONE_0004]"}
   }

2. DE-ANONYMIZATION EXAMPLE:
   
   LLM Output (Anonymized):
   "Thank you [PERSON_0001], [ORG_0003] has received your inquiry..."
   
   Using Mappings from Step 1:
   â€¢ [PERSON_0001] â†’ "John Doe"
   â€¢ [ORG_0003] â†’ "Acme Corp"
   
   Final Output (De-anonymized):
   "Thank you John Doe, Acme Corp has received your inquiry..."

3. EMAIL SEND FLOW:
   
   Reply Email:
   From: system@company.com
   To: john@example.com
   Subject: Re: Your Inquiry
   Body: Thank you John Doe, Acme Corp has received your inquiry...
   
   Forward Email:
   From: system@company.com
   To: coworker@company.com
   Subject: FWD: Your Inquiry
   Body: (Forward containing the auto-generated reply)
"""
    return diagram

def create_architecture_image():
    """Create architecture diagram as PNG image"""
    
    # Image dimensions
    width, height = 1400, 1600
    bg_color = (245, 245, 250)  # Light blue-gray
    
    # Create image
    img = Image.new('RGB', (width, height), bg_color)
    draw = ImageDraw.Draw(img)
    
    # Try to load fonts, fallback to default
    try:
        title_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 24, bold=True)
        section_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 16, bold=True)
        text_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 12)
        small_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 10)
    except:
        title_font = section_font = text_font = small_font = ImageFont.load_default()
    
    # Colors
    black = (0, 0, 0)
    white = (255, 255, 255)
    blue = (41, 128, 185)
    green = (46, 204, 113)
    red = (231, 76, 60)
    orange = (230, 126, 34)
    purple = (155, 89, 182)
    gray = (149, 165, 166)
    
    y = 30
    
    # Title
    draw.text((width//2 - 200, y), "AUTO_CHAT_24_7 SYSTEM ARCHITECTURE", fill=blue, font=title_font)
    y += 50
    
    # Layer 1: External Systems
    draw.rectangle([30, y, width-30, y+120], outline=blue, width=2)
    draw.text((50, y+10), "ğŸ“§ EXTERNAL SYSTEMS", fill=blue, font=section_font)
    
    # Mail components
    boxes = [
        ("Mail Portal\n(Inbox)", 80, y+50),
        ("Gmail IMAP\nimap.gmail.com", 400, y+50),
        ("SMTP Server\nsmtp.gmail.com", 720, y+50),
    ]
    
    for label, x, box_y in boxes:
        draw.rectangle([x, box_y, x+180, box_y+70], outline=green, width=2, fill=(220, 240, 220))
        draw.text((x+10, box_y+15), label, fill=black, font=text_font)
    
    y += 130
    
    # Layer 2: Application Layer
    draw.rectangle([30, y, width-30, y+180], outline=purple, width=2)
    draw.text((50, y+10), "ğŸ”’ APPLICATION LAYER", fill=purple, font=section_font)
    
    # Email Processor
    draw.rectangle([50, y+50, 650, y+170], outline=orange, width=2, fill=(255, 245, 220))
    draw.text((70, y+60), "EMAIL PROCESSOR", fill=orange, font=text_font)
    draw.text((70, y+85), "â€¢ fetch_unseen_emails()", fill=black, font=small_font)
    draw.text((70, y+105), "â€¢ send_email(to, subject, body)", fill=black, font=small_font)
    draw.text((70, y+125), "â€¢ Parse headers, extract body", fill=black, font=small_font)
    
    # Orchestration
    draw.rectangle([720, y+50, width-50, y+170], outline=orange, width=2, fill=(255, 245, 220))
    draw.text((740, y+60), "ORCHESTRATION MODULE", fill=orange, font=text_font)
    draw.text((740, y+85), "â€¢ auto_process()", fill=black, font=small_font)
    draw.text((740, y+105), "â€¢ Fetch â†’ Anonymize â†’ LLM â†’ Reply", fill=black, font=small_font)
    draw.text((740, y+125), "â€¢ Forward to coworker", fill=black, font=small_font)
    
    y += 190
    
    # Arrow down
    draw.line([(width//2, y-10), (width//2, y+10)], fill=black, width=2)
    draw.polygon([(width//2, y+10), (width//2-5, y), (width//2+5, y)], fill=black)
    
    y += 20
    
    # Layer 3: AI/NLP Processing
    draw.rectangle([30, y, width-30, y+250], outline=red, width=2)
    draw.text((50, y+10), "ğŸ¤– AI/NLP PROCESSING LAYER", fill=red, font=section_font)
    
    # Anonymization
    draw.rectangle([50, y+50, 450, y+220], outline=green, width=2, fill=(220, 245, 220))
    draw.text((70, y+60), "1ï¸âƒ£  ANONYMIZATION", fill=green, font=text_font)
    draw.text((70, y+85), "spaCy NER Model", fill=black, font=small_font)
    draw.text((70, y+105), "â€¢ Detect: PERSON, ORG", fill=black, font=small_font)
    draw.text((70, y+120), "  EMAIL, PHONE, DATE", fill=black, font=small_font)
    draw.text((70, y+140), "â€¢ Replace: [LABEL_UUID]", fill=black, font=small_font)
    draw.text((70, y+160), "â€¢ Store mappings", fill=black, font=small_font)
    draw.text((70, y+180), "Output: Anonymized text", fill=black, font=small_font)
    
    # LLM Inference
    draw.rectangle([500, y+50, 900, y+220], outline=purple, width=2, fill=(240, 220, 245))
    draw.text((520, y+60), "2ï¸âƒ£  LLM INFERENCE", fill=purple, font=text_font)
    draw.text((520, y+85), "Ollama/Mistral", fill=black, font=small_font)
    draw.text((520, y+105), "localhost:11434", fill=black, font=small_font)
    draw.text((520, y+125), "â€¢ Temperature: 0.7", fill=black, font=small_font)
    draw.text((520, y+145), "â€¢ Generate response", fill=black, font=small_font)
    draw.text((520, y+165), "â€¢ Return text output", fill=black, font=small_font)
    
    # De-anonymization
    draw.rectangle([950, y+50, width-50, y+220], outline=blue, width=2, fill=(220, 240, 255))
    draw.text((970, y+60), "3ï¸âƒ£  DE-ANONYMIZATION", fill=blue, font=text_font)
    draw.text((970, y+85), "Restore Original Data", fill=black, font=small_font)
    draw.text((970, y+105), "â€¢ Match placeholders", fill=black, font=small_font)
    draw.text((970, y+120), "  [LABEL_UUID]", fill=black, font=small_font)
    draw.text((970, y+140), "â€¢ Replace with original", fill=black, font=small_font)
    draw.text((970, y+160), "â€¢ Output: Final response", fill=black, font=small_font)
    
    y += 260
    
    # Arrow down
    draw.line([(width//2, y-10), (width//2, y+10)], fill=black, width=2)
    draw.polygon([(width//2, y+10), (width//2-5, y), (width//2+5, y)], fill=black)
    
    y += 20
    
    # Layer 4: Output/Logging
    draw.rectangle([30, y, width-30, y+150], outline=gray, width=2)
    draw.text((50, y+10), "ğŸ“ LOGGING & OUTPUT LAYER", fill=gray, font=section_font)
    
    log_boxes = [
        ("Before.txt\n(Original)", 80, y+50),
        ("After.txt\n(Anonymized)", 300, y+50),
        ("Response.txt\n(LLM Output)", 520, y+50),
        ("Map.txt\n(Mappings)", 740, y+50),
    ]
    
    for label, x, box_y in log_boxes:
        draw.rectangle([x, box_y, x+140, box_y+80], outline=gray, width=2, fill=(235, 235, 235))
        draw.text((x+10, box_y+20), label, fill=black, font=small_font)
    
    y += 160
    
    # Footer
    draw.text((30, y), "Security: Anonymization protects PII | Local LLM ensures data privacy | Audit trail maintained", 
              fill=red, font=small_font)
    
    # Save image
    os.makedirs("docs", exist_ok=True)
    img.save("docs/architecture_diagram.png")
    print("âœ… Architecture diagram saved to: docs/architecture_diagram.png")
    return img

def create_dataflow_image():
    """Create data flow diagram as PNG image"""
    
    width, height = 1200, 2000
    bg_color = (245, 250, 245)
    
    img = Image.new('RGB', (width, height), bg_color)
    draw = ImageDraw.Draw(img)
    
    # Fonts
    try:
        title_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 22, bold=True)
        section_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 14, bold=True)
        text_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 11)
        small_font = ImageFont.truetype("/System/Library/Fonts/Arial.ttf", 9)
    except:
        title_font = section_font = text_font = small_font = ImageFont.load_default()
    
    # Colors
    black = (0, 0, 0)
    blue = (41, 128, 185)
    green = (46, 204, 113)
    red = (231, 76, 60)
    orange = (230, 126, 34)
    purple = (155, 89, 182)
    gray = (149, 165, 166)
    yellow = (241, 196, 15)
    
    y = 30
    
    # Title
    draw.text((width//2 - 200, y), "DATA FLOW DIAGRAM", fill=blue, font=title_font)
    draw.text((width//2 - 250, y+35), "AUTO_CHAT_24_7 EMAIL PROCESSING", fill=gray, font=section_font)
    y += 80
    
    # Step 1: Sender's Email
    box_width, box_height = 300, 80
    x_center = width // 2 - box_width // 2
    draw.rectangle([x_center, y, x_center + box_width, y + box_height], 
                   outline=blue, width=2, fill=(220, 240, 255))
    draw.text((x_center + 30, y + 15), "ğŸ“§ SENDER'S EMAIL", fill=blue, font=section_font)
    draw.text((x_center + 30, y + 45), "From, Subject, Body", fill=black, font=text_font)
    y += box_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 2: Email Fetch
    draw.rectangle([x_center, y, x_center + box_width, y + box_height], 
                   outline=green, width=2, fill=(220, 245, 220))
    draw.text((x_center + 30, y + 15), "ğŸ” FETCH EMAIL", fill=green, font=section_font)
    draw.text((x_center + 30, y + 45), "IMAP: Connect & Parse", fill=black, font=text_font)
    y += box_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 3: Create Prompt
    draw.rectangle([x_center, y, x_center + box_width, y + box_height], 
                   outline=orange, width=2, fill=(255, 245, 220))
    draw.text((x_center + 30, y + 15), "ğŸ“ CREATE PROMPT", fill=orange, font=section_font)
    draw.text((x_center + 30, y + 45), "Build LLM request", fill=black, font=text_font)
    y += box_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 4: Anonymization (Large box)
    anon_height = 180
    draw.rectangle([x_center, y, x_center + box_width, y + anon_height], 
                   outline=red, width=3, fill=(255, 240, 240))
    draw.text((x_center + 30, y + 15), "ğŸ” ANONYMIZATION", fill=red, font=section_font)
    draw.text((x_center + 30, y + 45), "spaCy NER Detection:", fill=black, font=text_font)
    draw.text((x_center + 40, y + 65), "âœ“ PERSON: John â†’ [PERSON_001]", fill=black, font=small_font)
    draw.text((x_center + 40, y + 80), "âœ“ ORG: Acme â†’ [ORG_002]", fill=black, font=small_font)
    draw.text((x_center + 40, y + 95), "âœ“ EMAIL, PHONE, DATE", fill=black, font=small_font)
    draw.text((x_center + 30, y + 120), "Output: Mappings stored", fill=black, font=text_font)
    y += anon_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 5: Log Before
    draw.rectangle([50, y, 250, y + 80], outline=gray, width=2, fill=(240, 240, 240))
    draw.text((60, y + 20), "ğŸ’¾ Before.txt", fill=gray, font=text_font)
    draw.text((60, y + 45), "(Original)", fill=black, font=small_font)
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+15)], fill=black, width=2)
    
    # Step 6: Log After
    draw.rectangle([(width-250), y, width-50, y + 80], outline=gray, width=2, fill=(240, 240, 240))
    draw.text((width-240, y + 20), "ğŸ’¾ After.txt", fill=gray, font=text_font)
    draw.text((width-240, y + 45), "(Anonymized)", fill=black, font=small_font)
    
    y += 100
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 7: LLM Processing (Large box)
    llm_height = 180
    draw.rectangle([x_center, y, x_center + box_width, y + llm_height], 
                   outline=purple, width=3, fill=(240, 220, 245))
    draw.text((x_center + 30, y + 15), "ğŸ¤– LLM INFERENCE", fill=purple, font=section_font)
    draw.text((x_center + 30, y + 45), "Ollama/Mistral", fill=black, font=text_font)
    draw.text((x_center + 30, y + 65), "Endpoint: localhost:11434", fill=black, font=small_font)
    draw.text((x_center + 30, y + 80), "Temperature: 0.7", fill=black, font=small_font)
    draw.text((x_center + 30, y + 100), "Input: Anonymized prompt", fill=black, font=small_font)
    draw.text((x_center + 30, y + 120), "Output: Generated response", fill=black, font=small_font)
    draw.text((x_center + 30, y + 140), "(still anonymized)", fill=black, font=small_font)
    y += llm_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 8: Log Response
    draw.rectangle([50, y, 250, y + 80], outline=gray, width=2, fill=(240, 240, 240))
    draw.text((60, y + 20), "ğŸ’¾ Response.txt", fill=gray, font=text_font)
    draw.text((60, y + 45), "(LLM Output)", fill=black, font=small_font)
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+15)], fill=black, width=2)
    
    # Step 9: Log Mappings
    draw.rectangle([(width-250), y, width-50, y + 80], outline=gray, width=2, fill=(240, 240, 240))
    draw.text((width-240, y + 20), "ğŸ’¾ Map.txt", fill=gray, font=text_font)
    draw.text((width-240, y + 45), "(Mappings)", fill=black, font=small_font)
    
    y += 100
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 10: De-anonymization (Large box)
    deanon_height = 180
    draw.rectangle([x_center, y, x_center + box_width, y + deanon_height], 
                   outline=blue, width=3, fill=(220, 240, 255))
    draw.text((x_center + 30, y + 15), "ğŸ”“ DE-ANONYMIZATION", fill=blue, font=section_font)
    draw.text((x_center + 30, y + 45), "Restore Original Data", fill=black, font=text_font)
    draw.text((x_center + 40, y + 65), "Match: [PERSON_001]", fill=black, font=small_font)
    draw.text((x_center + 40, y + 80), "Replace: John (original)", fill=black, font=small_font)
    draw.text((x_center + 40, y + 95), "Match: [ORG_002]", fill=black, font=small_font)
    draw.text((x_center + 40, y + 110), "Replace: Acme (original)", fill=black, font=small_font)
    draw.text((x_center + 30, y + 135), "Output: Final restored reply", fill=black, font=text_font)
    y += deanon_height + 30
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 11: Send & Forward
    draw.rectangle([50, y, width-50, y + 100], outline=green, width=2, fill=(220, 245, 220))
    draw.text((70, y + 15), "ğŸ“¤ SEND EMAIL REPLIES", fill=green, font=section_font)
    draw.text((70, y + 45), "1. Reply to Sender (SMTP)        2. Forward to Coworker (SMTP)", 
              fill=black, font=text_font)
    draw.text((70, y + 65), "   To: sender@example.com          To: coworker@company.com", 
              fill=black, font=small_font)
    y += 120
    
    # Arrow
    draw.line([(width//2, y-15), (width//2, y+5)], fill=black, width=2)
    draw.polygon([(width//2, y+5), (width//2-5, y-5), (width//2+5, y-5)], fill=black)
    y += 15
    
    # Step 12: Complete
    draw.rectangle([x_center, y, x_center + box_width, y + box_height], 
                   outline=green, width=2, fill=(220, 245, 220))
    draw.text((x_center + 30, y + 15), "âœ… PROCESS COMPLETE", fill=green, font=section_font)
    draw.text((x_center + 30, y + 45), "Sleep 60s â†’ Check again", fill=black, font=text_font)
    
    # Save image
    os.makedirs("docs", exist_ok=True)
    img.save("docs/dataflow_diagram.png")
    print("âœ… Data flow diagram saved to: docs/dataflow_diagram.png")
    return img

if __name__ == "__main__":
    print("\n" + "="*80)
    print("GENERATING DIAGRAMS")
    print("="*80)
    
    # Create docs directory if it doesn't exist
    os.makedirs("docs", exist_ok=True)
    print("âœ… Created docs/ directory")
    
    # ASCII Diagrams
    print("\n1ï¸âƒ£  Generating ASCII Architecture Diagram...")
    ascii_arch = generate_ascii_architecture()
    with open("docs/architecture_ascii.txt", "w", encoding="utf-8") as f:
        f.write(ascii_arch)
    print("âœ… Saved to: docs/architecture_ascii.txt")
    
    print("\n2ï¸âƒ£  Generating ASCII Data Flow Diagram...")
    ascii_flow = generate_ascii_dataflow()
    with open("docs/dataflow_ascii.txt", "w", encoding="utf-8") as f:
        f.write(ascii_flow)
    print("âœ… Saved to: docs/dataflow_ascii.txt")
    
    # PNG Images
    print("\n3ï¸âƒ£  Generating PNG Architecture Diagram...")
    create_architecture_image()
    
    print("\n4ï¸âƒ£  Generating PNG Data Flow Diagram...")
    create_dataflow_image()
    
    print("\n" + "="*80)
    print("ALL DIAGRAMS GENERATED SUCCESSFULLY")
    print("="*80)
    print("\nğŸ“ Output files:")
    print("   â€¢ docs/architecture_ascii.txt")
    print("   â€¢ docs/dataflow_ascii.txt")
    print("   â€¢ docs/architecture_diagram.png")
    print("   â€¢ docs/dataflow_diagram.png")
    print("\n" + "="*80)
